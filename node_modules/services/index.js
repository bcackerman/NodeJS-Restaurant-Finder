var Factual = require('factual-api');
var request = require('request');
var util = require('util');

var restaurantFinder = function(address){
	var factual_oauth_key = "rDm3avowlKT61SmcCufYtf57KwnN5Nd5Lb7kzXZr";
	var factual_oauth_secret = "0oVvYOaPuxwY2eDT18vy16aakoX6eq72UbGPypIO";
	var factual = new Factual(factual_oauth_key, factual_oauth_secret);

	request('http://maps.googleapis.com/maps/api/geocode/json?address='+address+'&sensor=false', function (err, res, json) {
	  data = JSON.parse(json);
	  var longitude = data.results[0].geometry.location.lng;
	  var latitude = data.results[0].geometry.location.lat;

	  factual.get('/t/restaurants', {geo:{"$circle":{"$center":[latitude,longitude],"$meters":1000}}}, function (error, res) {
	    console.log(res.data);
	  });
	});
}


exports.restaurantFinder = restaurantFinder;